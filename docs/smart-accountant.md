# مستندات ماژول: حسابدار هوشمند

## معرفی

"حسابدار هوشمند" یک ابزار جامع برای مدیریت مالی شخصی است. این ماژول به کاربران امکان می‌دهد تا درآمدها و هزینه‌ها، دارایی‌ها، اقساط، چک‌ها و بدهی/طلب خود از دیگران را ثبت و پیگیری کنند.

## ساختار فایل‌ها

- **`SmartAccountant.tsx`**: کامپوننت اصلی که شامل منطق نمایش تب‌ها و کامپوننت‌های مربوط به هر بخش است. این فایل همچنین شامل کامپوننت‌های داخلی برای هر تب (`SummaryView`, `TransactionsView`, `AssetsView`, `PeopleView`, `InstallmentsView`, `ChecksView`) است.
- **`store.ts`**: مهم‌ترین فایل این ماژول که تمام منطق و داده‌های مالی را با `useAccountantStore` مدیریت می‌کند.
- **`types.ts`**: شامل تعریف تمام ساختارهای داده‌ای پیچیده این ماژول مانند `AccountantData`, `Transaction`, `Asset`, `Person`, `LedgerEntry`, `InstallmentPlan`, `InstallmentPayment` و `Check`.
- **`constants.ts`**: شامل دسته‌بندی‌های پیش‌فرض برای درآمدها و هزینه‌ها.

## مدیریت وضعیت (`store.ts`)

این ماژول به دلیل پیچیدگی داده‌ها، دارای یک store قدرتمند است.

### State

- **`transactions`**: آرایه‌ای از تمام تراکنش‌ها (درآمد/هزینه).
- **`assets`**: آرایه‌ای از دارایی‌های کاربر.
- **`people`**: آرایه‌ای از اشخاصی که کاربر با آن‌ها حساب مالی دارد.
- **`ledger`**: یک آبجکت که حساب‌های مالی با اشخاص را نگهداری می‌کند. کلید هر آیتم `personId` و مقدار آن آرایه‌ای از `LedgerEntry` (بدهی/طلب) است.
- **`installments`**: آرایه‌ای از برنامه‌های اقساط کاربر.
- **`checks`**: آرایه‌ای از چک‌های صادره و دریافتی.

### Actions (توابع)

این store شامل توابع تفکیک شده برای هر بخش است:
- **تراکنش‌ها**: `saveTransaction`, `deleteTransaction`
- **دارایی‌ها**: `saveAsset`, `deleteAsset`
- **اشخاص**: `savePerson`, `deletePerson`
- **حساب دفتری (Ledger)**: `saveLedgerEntry`, `deleteLedgerEntry`, `toggleSettle` (برای تغییر وضعیت تسویه یک حساب)
- **اقساط**:
    - `saveInstallmentPlan`: برای ایجاد یک برنامه قسط جدید.
    - `updateInstallmentPlan`: برای ویرایش عنوان و مبلغ وام یک برنامه قسط.
    - `deleteInstallmentPlan`: برای حذف کامل یک برنامه قسط.
    - `updateInstallmentPayment`: برای ویرایش مبلغ و تاریخ یک قسط.
    - `togglePaidStatus`: برای تغییر وضعیت پرداخت یک قسط.
- **چک‌ها**:
    - `saveCheck`: برای افزودن یا ویرایش یک چک.
    - `deleteCheck`: برای حذف یک چک.
    - `updateCheckStatus`: برای تغییر وضعیت یک چک (در انتظار، پاس شده، برگشت خورده).

تمام وضعیت در `localStorage` تحت کلید `lifeManagerAccountant` ذخیره می‌شود.

## کامپوننت‌ها و جریان کاری

- **رابط کاربری تَب-محور**: کاربر بین بخش‌های "خلاصه"، "تراکنش‌ها"، "چک‌ها"، "اقساط"، "دارایی‌ها" و "حساب با دیگران" جابجا می‌شود.
- **کامپوننت‌های View**: هر تب، یک کامپوننت View اختصاصی دارد که مسئول نمایش داده‌های مربوطه است. این کار به تمیز نگه داشتن کامپوننت اصلی کمک می‌کند.
- **مودال هوشمند (`AccountantFormModal`)**: یک مودال واحد برای تمام عملیات افزودن/ویرایش استفاده می‌شود. این مودال بر اساس `type` ورودی (`transaction`, `asset`, `person` و...) فرم مناسب را به صورت پویا رندر می‌کند.
- **انتخابگر تاریخ شمسی (`JalaliDatePicker`)**: یک کامپوننت سفارشی برای انتخاب تاریخ شمسی ساخته شده است.
- **حساب با دیگران**:
    1. ابتدا کاربر یک شخص جدید را اضافه می‌کند.
    2. سپس با کلیک بر روی آن شخص، وارد صفحه جزئیات حساب او می‌شود.
    3. در این صفحه می‌تواند بدهی یا طلب جدید ثبت کرده، حساب‌ها را تسویه کند یا موارد قبلی را ویرایش/حذف نماید.
- **مدیریت اقساط**:
    1. کاربر یک "برنامه قسط" جدید با مشخص کردن مبلغ، تعداد و تاریخ اولین پرداخت ایجاد می‌کند.
    2. با کلیک بر روی برنامه، لیست تمام اقساط آن نمایش داده می‌شود.
    3. کاربر می‌تواند هر قسط را به عنوان "پرداخت شده" علامت بزند یا جزئیات آن را ویرایش کند.
- **مدیریت چک‌ها**:
    1. کاربر با کلیک روی دکمه افزودن در تب "چک‌ها"، یک چک جدید ثبت می‌کند.
    2. در فرم، نوع چک (صادره/دریافتی)، مبلغ، تاریخ سررسید، اطلاعات طرف حساب و شناسه صیادی را وارد می‌کند.
    3. چک‌ها در لیست مربوطه (صادره یا دریافتی) نمایش داده می‌شوند.
    4. کاربر می‌تواند وضعیت هر چک را به "پاس شده" یا "برگشت خورده" تغییر دهد.
    5. در داشبورد، مجموع مبلغ چک‌های صادره که سررسیدشان در ماه جاری است، نمایش داده می‌شود.